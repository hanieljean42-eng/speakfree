<!DOCTYPE html>
<html>
<head>
    <title>Test Boutons</title>
</head>
<body>
    <h1>Test des boutons Super Admin</h1>
    
    <div id="result" style="padding: 20px; background: #f0f0f0; margin: 20px 0;"></div>
    
    <h2>√âcoles Actives</h2>
    <div id="schools"></div>
    
    <script src="/config.js"></script>
    <script>
        // Attendre que CONFIG soit charg√©
        console.log('CONFIG:', typeof CONFIG !== 'undefined' ? 'OK' : 'NON D√âFINI');
        console.log('API_URL:', CONFIG ? CONFIG.API_URL : 'N/A');
        
        document.getElementById('result').innerHTML = `
            <p><strong>CONFIG:</strong> ${typeof CONFIG !== 'undefined' ? '‚úÖ OK' : '‚ùå NON D√âFINI'}</p>
            <p><strong>API_URL:</strong> ${CONFIG ? CONFIG.API_URL : 'N/A'}</p>
        `;
        
        // Charger les √©coles
        fetch(CONFIG.API_URL + '/api/super-admin/schools/active')
            .then(r => r.json())
            .then(data => {
                console.log('√âcoles:', data);
                let html = '';
                if (data.schools && data.schools.length > 0) {
                    data.schools.forEach(school => {
                        html += `
                            <div style="border: 1px solid #ccc; padding: 15px; margin: 10px 0; border-radius: 8px;">
                                <h3>${school.name}</h3>
                                <p>ID: ${school.id} | Code: ${school.school_code}</p>
                                <button onclick="testDetails(${school.id})" style="padding: 10px 20px; margin: 5px; cursor: pointer;">üëÅÔ∏è D√©tails</button>
                                <button onclick="testDeactivate(${school.id})" style="padding: 10px 20px; margin: 5px; background: #ffc107; cursor: pointer;">‚è∏Ô∏è D√©sactiver</button>
                                <button onclick="testDelete(${school.id})" style="padding: 10px 20px; margin: 5px; background: #dc3545; color: white; cursor: pointer;">üóëÔ∏è Supprimer</button>
                            </div>
                        `;
                    });
                } else {
                    html = '<p>Aucune √©cole active</p>';
                }
                document.getElementById('schools').innerHTML = html;
            })
            .catch(err => {
                document.getElementById('schools').innerHTML = '<p style="color: red;">Erreur: ' + err.message + '</p>';
            });
        
        // Fonctions de test
        function testDetails(id) {
            console.log('testDetails appel√© avec ID:', id);
            alert('Fonction D√©tails appel√©e pour √©cole ID: ' + id);
            
            fetch(CONFIG.API_URL + '/api/super-admin/schools/' + id + '/details')
                .then(r => r.json())
                .then(data => {
                    console.log('D√©tails:', data);
                    if (data.error) {
                        alert('Erreur: ' + data.error);
                    } else {
                        alert('√âcole: ' + data.school.name + '\nVille: ' + (data.school.city || 'N/A'));
                    }
                })
                .catch(err => alert('Erreur: ' + err.message));
        }
        
        function testDeactivate(id) {
            console.log('testDeactivate appel√© avec ID:', id);
            if (confirm('D√©sactiver cette √©cole ?')) {
                fetch(CONFIG.API_URL + '/api/super-admin/schools/' + id + '/deactivate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ code: '200700' })
                })
                .then(r => r.json())
                .then(data => {
                    console.log('R√©sultat:', data);
                    alert(data.message || data.error);
                    location.reload();
                })
                .catch(err => alert('Erreur: ' + err.message));
            }
        }
        
        function testDelete(id) {
            console.log('testDelete appel√© avec ID:', id);
            if (confirm('SUPPRIMER cette √©cole ? Cette action est irr√©versible !')) {
                fetch(CONFIG.API_URL + '/api/super-admin/schools/' + id, {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ code: '200700' })
                })
                .then(r => r.json())
                .then(data => {
                    console.log('R√©sultat:', data);
                    alert(data.message || data.error);
                    location.reload();
                })
                .catch(err => alert('Erreur: ' + err.message));
            }
        }
    </script>
</body>
</html>
